# 亚马逊产品竞争性分析系统

## 项目简介

为可爱女友呆呆狸开发的亚马逊产品竞争性分析自动化工具，用于分析自己的产品在亚马逊市场上的竞争情况。该系统能够自动爬取亚马逊上的产品信息，通过图像分析和关键词匹配来判断竞品关系，并生成详细的竞争性分析报告。

## 功能特点

- **自动化数据采集**：从Excel提取搜索词，自动在亚马逊搜索并下载产品图片
- **智能竞品识别**：结合通义千问视觉AI和关键词匹配双重判定竞品关系
- **相似度评估**：根据竞品数量和比例计算市场相似度级别（高/中/低）
- **详细分析报告**：自动生成Excel格式的分析报告，包含竞品数量、相似度等关键指标
- **断点续传**：每分析完一个产品就保存一次结果，不会因中途中断而丢失数据
- **资源复用**：智能检测并复用已爬取的数据，提高效率

## 环境要求

- Python 3.7+
- Chrome浏览器及对应版本的ChromeDriver

## 依赖库

```
selenium==4.10.0
pandas==1.5.3
requests==2.28.2
openai==1.3.0
dashscope==1.10.0
```

## 安装步骤

1. 克隆或下载本项目到本地
   ```
   git clone https://github.com/yourusername/amazon-product-analysis.git
   cd amazon-product-analysis
   ```

2. 安装依赖库
   ```
   pip install -r requirements.txt
   ```

3. 准备环境
   - 确保已安装Chrome浏览器
   - 下载与Chrome版本匹配的ChromeDriver，并将其添加到系统PATH中
   - 在项目根目录下创建`my_product_image`文件夹

## 使用说明

### 准备工作

1. 准备Excel文件（默认名称为`红白蓝五星窗户灯词库_更新_20250318_151413.xlsx`），第一列应为产品搜索词
2. 将自己的产品图片放入`my_product_image`文件夹，文件名应与Excel中的搜索词一致
3. 在代码中更新API密钥和其他配置参数

### 运行系统

```
python amazon_product_analysis.py
```

系统会自动执行以下流程：
1. 从Excel提取搜索词
2. 遍历每个搜索词，在亚马逊搜索并下载产品图片
3. 分析每个产品与亚马逊搜索结果的相似度
4. 生成相似度分析报告并保存为Excel文件

### 分析结果

分析结果将保存在`产品相似度分析结果.xlsx`文件中，包含以下信息：
- 产品名：搜索词/产品名称
- 相似度：高度相似/中度相似/低度相似/无法评估
- 竞品数量：找到的竞品数量
- 总商品数：搜索结果中的总商品数
- 竞品百分比：竞品占总商品的百分比
- 竞品列表：所有被认为是竞品的产品文件名

## 代码结构

- **配置参数**：API密钥、模型名称、图片目录等配置
- **辅助函数**：关键词提取、图片分析等功能
- **浏览器配置**：Selenium自动化浏览器设置
- **元素交互函数**：网页元素查找与操作
- **亚马逊爬虫函数**：搜索商品、下载图片
- **整合工作流程**：完整分析流程的实现

## 注意事项

1. **API密钥安全**：确保API密钥不被泄露，建议使用环境变量或配置文件管理
2. **反爬虫机制**：亚马逊有严格的反爬虫机制，过于频繁的请求可能导致IP被封禁
3. **图片匹配**：确保`my_product_image`中的图片文件名与Excel中的搜索词完全一致
4. **网络稳定性**：运行过程需要稳定的网络环境，以确保能正常访问亚马逊和API服务

## 常见问题

### Q: 为什么系统报告"找不到匹配的产品图片"？
A: 请检查`my_product_image`文件夹中的图片文件名是否与Excel中的搜索词完全一致。

### Q: 为什么爬取亚马逊时出现验证码？
A: 亚马逊检测到自动化行为，可以尝试减慢请求频率，或使用代理IP。

### Q: 通义千问API返回错误怎么办？
A: 检查API密钥是否正确，以及请求频率是否超过限制。

### Q: 如何优化相似度判断的准确性？
A: 可以调整`USER_PROMPT`中的判断标准，或者修改`get_title_analyze`和`calculate_similarity_level`函数的逻辑。

## 维护与更新

本项目仍在持续更新中，欢迎提交问题和建议。如遇到任何技术问题，请提交issue。

---

© 2025 亚马逊产品竞争性分析系统